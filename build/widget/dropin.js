"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _typeof(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(e){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.widget=e()}}(function(){var e;return function t(e,n,r){function i(o,u){if(!n[o]){if(!e[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var c=n[o]={exports:{}};e[o][0].call(c.exports,function(t){var n=e[o][1][t];return i(n?n:t)},c,c.exports,t,e,n,r)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){var r=e("widget/dropin");e("framebus");n.setup=function(e){var t=new r;t.appendTo(e),t.on("ready",function(e,t){console.log("Child ("+t.url+") reported ready")})}},{framebus:4,"widget/dropin":2}],2:[function(e,t,n){var r=(e("inherits"),e("events").EventEmitter),i=e("framebus"),s=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return n.element=document.createElement("iframe"),n.element.setAttribute("src","http://localhost:3001/"),n}return _inherits(t,e),_createClass(t,[{key:"appendTo",value:function(e){"string"==typeof e&&(e=document.querySelector(e)),this.handleMessages(e),this.interceptSubmit(e),e.appendChild(this.element)}},{key:"handleMessages",value:function(e){var t=this;i.on("widget-ready",function(n){t.emit(n.method,e,n.data),i.emit("parent-ready",document.location.href)})}},{key:"interceptSubmit",value:function(e){for(var t=e;t&&"FORM"!=t.nodeName;)t=t.parentNode;i.on("widget-data",function(e){var n=document.createElement("input");n.setAttribute("name","name"),n.setAttribute("type","hidden"),n.setAttribute("value",e.name),t.appendChild(n),t.submit()}),t.addEventListener("submit",function(e){e.preventDefault(),i.emit("submit")})}}]),t}(r);t.exports=s},{events:3,framebus:4,inherits:5}],3:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function s(e){return"number"==typeof e}function o(e){return"object"===("undefined"==typeof e?"undefined":_typeof(e))&&null!==e}function u(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!s(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,s,a,f;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],u(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(o(n))for(s=Array.prototype.slice.call(arguments,1),f=n.slice(),r=f.length,a=0;r>a;a++)f[a].apply(this,s);return!0},r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(n=u(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,s,u;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(u=s;u-->0;)if(n[u]===t||n[u].listener&&n[u].listener===t){r=u;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],4:[function(t,n,r){!function(t,i){"object"===("undefined"==typeof r?"undefined":_typeof(r))&&"undefined"!=typeof n?n.exports=i():"function"==typeof e&&e.amd?e([],i):t.framebus=i()}(this,function(){function e(e){return null==e?!1:null==e.Window?!1:e.constructor!==e.Window?!1:(_.push(e),!0)}function t(e){var t,n={};for(t in g)g.hasOwnProperty(t)&&(n[t]=g[t]);return n._origin=e||"*",n}function n(e){var t,n,r=s(this);return o(e)?!1:o(r)?!1:(n=Array.prototype.slice.call(arguments,1),t=u(e,n,r),t===!1?!1:(h(y.top,t,r),!0))}function r(e,t){var n=s(this);return m(e,t,n)?!1:(b[n]=b[n]||{},b[n][e]=b[n][e]||[],b[n][e].push(t),!0)}function i(e,t){var n,r,i=s(this);if(m(e,t,i))return!1;if(r=b[i]&&b[i][e],!r)return!1;for(n=0;n<r.length;n++)if(r[n]===t)return r.splice(n,1),!0;return!1}function s(e){return e&&e._origin||"*"}function o(e){return"string"!=typeof e}function u(e,t,n){var r=!1,i={event:e,origin:n},s=t[t.length-1];"function"==typeof s&&(i.reply=d(s,n),t=t.slice(0,-1)),i.args=t;try{r=x+JSON.stringify(i)}catch(o){throw new Error("Could not stringify event: "+o.message)}return r}function a(e){var t,n,r,i;if(e.data.slice(0,x.length)!==x)return!1;try{t=JSON.parse(e.data.slice(x.length))}catch(s){return!1}return null!=t.reply&&(n=e.origin,r=e.source,i=t.reply,t.reply=function(e){var t=u(i,[e],n);return t===!1?!1:void r.postMessage(t,n)},t.args.push(t.reply)),t}function f(e){y||(y=e||window,y.addEventListener?y.addEventListener("message",l,!1):y.attachEvent?y.attachEvent("onmessage",l):null===y.onmessage?y.onmessage=l:y=null)}function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)})}function l(e){var t;o(e.data)||(t=a(e),t&&(p("*",t.event,t.args,e),p(e.origin,t.event,t.args,e),v(e.data,t.origin,e.source)))}function p(e,t,n,r){var i;if(b[e]&&b[e][t])for(i=0;i<b[e][t].length;i++)b[e][t][i].apply(r,n)}function h(e,t,n){var r;try{e.postMessage(t,n)}catch(i){return}for(e.opener&&e.opener!==e&&!e.opener.closed&&e.opener!==y&&h(e.opener.top,t,n),r=0;r<e.frames.length;r++)h(e.frames[r],t,n)}function v(e,t,n){var r,i;for(r=_.length-1;r>=0;r--)i=_[r],i.closed===!0?_=_.slice(r,1):n!==i&&h(i.top,e,t)}function d(e,t){function n(i,s){e(i,s),g.target(t).unsubscribe(r,n)}var r=c();return g.target(t).subscribe(r,n),r}function m(e,t,n){return o(e)?!0:"function"!=typeof t?!0:o(n)?!0:!1}var y,g,_=[],b={},x="/*framebus*/";return f(),g={target:t,include:e,publish:n,pub:n,trigger:n,emit:n,subscribe:r,sub:r,on:r,unsubscribe:i,unsub:i,off:i}})},{}],5:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}]},{},[1])(1)});